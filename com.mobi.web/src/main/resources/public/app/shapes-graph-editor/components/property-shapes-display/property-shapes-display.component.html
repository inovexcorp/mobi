<!--
  #%L
  com.mobi.web
  $Id:$
  $HeadURL:$
  %%
  Copyright (C) 2016 - 2025 iNovex Information Systems, Inc.
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #L%
  -->
<div class="property-shapes-display">
  <div class="section-header">
    <h5>Constraints</h5>
    <a class="pl-1 text-muted" [matMenuTriggerFor]="constraintInfo"><mat-icon>info</mat-icon></a>
    <a *ngIf="canModify" class="float-right fa fa-fw fa-plus" (click)="openAddOverlay()"></a>
  </div>
  <mat-card *ngFor="let propertyShape of propertyShapes" class="property-shape mb-2">
    <mat-card-title><h5 class="property-shape-label">{{propertyShape.label}}</h5></mat-card-title>
    <mat-card-subtitle>
      <div class="path-display">
        <span class="label-header">Path: </span>
        <span [innerHTML]="propertyShape.pathHtmlString"></span>
      </div>
      <div>
        <span class="label-header">Message: </span>
        <span>{{propertyShape.message || 'N/A'}}</span>
      </div>
    </mat-card-subtitle>
    <mat-card-content>
      <div class="label-header">Constraint(s)</div>
      <div *ngFor="let constraint of propertyShape.constraints" class="constraint">
        <span class="subheader">{{constraint.constraintLabel}}: </span><span *ngFor="let value of constraint.value; last as last" [title]="value.chosenValue">{{value.label}}<span *ngIf="!last">, </span></span>
      </div>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button color="warn" (click)="confirmPropertyShapeDeletion(propertyShape)" [disabled]="!canModify || isImported">Delete</button>
    </mat-card-actions>
  </mat-card>
</div>
<mat-menu #constraintInfo="matMenu">
  <div class="info-menu p-1">
    <p>Constraints are grouped into what are called <a href="https://www.w3.org/TR/shacl/#property-shapes" target="_blank">Property Shapes</a> that describe all constraints to be applied to a particular "path" through the graph data.</p>
    <p>The path is displayed according to the following syntax:</p>
    <dl>
      <dt>Forward Slash <strong>/</strong></dt>
      <dd>Represents a sequential path.</dd>
      <dt>Vertical Bar <strong>|</strong></dt>
      <dd>Represents an alternative path.</dd>
      <dt>Caret <strong>^</strong></dt>
      <dd>Represents an inverse path.</dd>
      <dt>Asterisk <strong>*</strong></dt>
      <dd>Represents a path to be followed zero or more times.</dd>
      <dt>Plus <strong>+</strong></dt>
      <dd>Represents a path to be followed one or more times.</dd>
      <dt>Question Mark <strong>?</strong></dt>
      <dd>Represents a path to be followed zero or one time.</dd>
    </dl>
  </div>
</mat-menu>
