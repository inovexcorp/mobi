<!--
  #%L
  com.mobi.web
  $Id:$
  $HeadURL:$
  %%
  Copyright (C) 2016 - 2025 iNovex Information Systems, Inc.
  %%
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU Affero General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  #L%
  -->
<div class="shacl-target w-100">
  <div class="section-header d-flex justify-content-between align-items-center w-100">
    <h5 class="m-0">Target</h5>
    <div class="header-actions d-flex align-items-center gap-2">
      <div *ngIf="canModify && !isImported" class="text-muted">
        <!-- Use ngSwitch to cleanly manage UI based on the component's state -->
        <div class="action-buttons-container" [ngSwitch]="editMode">
          <!-- Mode: DISABLED -->
          <ng-container *ngSwitchCase="EditMode.Disabled">
            <button mat-icon-button class="edit-button" color="primary" title="Edit SHACL Target" (click)="onEdit()">
              <i class="fa fa-pencil"></i> <!-- Change for consistency? <mat-icon>edit</mat-icon> -->
            </button>
          </ng-container>
          <!-- Mode: ENABLED -->
          <ng-container *ngSwitchCase="EditMode.Enabled">
            <button mat-icon-button class="reset-button" color="accent" title="Clear Value" (click)="onReset()">
              <mat-icon>restart_alt</mat-icon>
            </button>
            <button mat-icon-button class="save-button" color="primary" title="Save Changes"
              [disabled]="targetForm.invalid" (click)="onSave()">
              <mat-icon>save</mat-icon>
            </button>
          </ng-container>
        </div>
      </div>
      <a class="text-muted" [matMenuTriggerFor]="targetInfo"><mat-icon>info</mat-icon></a>
    </div>
  </div>
  <form class="shacl-target-form" [formGroup]="targetForm">
    <!-- Target Radio Buttons -->
    <app-shacl-target-selector formControlName="target" (selectionChange)="handleTargetChange($event)">
    </app-shacl-target-selector>
    
    <!-- Target Value Field -->
    <ng-container *ngIf="targetOption" [ngSwitch]="targetOption.iri">
      <ng-container *ngSwitchCase="IMPLICIT_REFERENCE">
      </ng-container>
      <app-shacl-target-node-input *ngSwitchCase="TARGET_NODE" class="target-input" formControlName="targetValue"
        [label]="targetOption.valueLabel">
      </app-shacl-target-node-input>
      <app-shacl-single-suggestion-input *ngSwitchCase="TARGET_CLASS"
        class="target-input"
        formControlName="targetValue"
        [label]="targetOption.valueLabel">
      </app-shacl-single-suggestion-input>
      <app-shacl-chip-suggestions-input *ngSwitchDefault
        class="target-input"
        formControlName="targetValues"
        [label]="targetOption.valueLabel"
        [pullClasses]="false"
        [propertyTypes]="targetOption.iri === TARGET_OBJECTS_OF ? ['ObjectProperty'] : []">
      </app-shacl-chip-suggestions-input>
    </ng-container>
  </form>
</div>
<mat-menu #targetInfo="matMenu">
  <div class="info-menu p-1">
    See the Specification for more details about the <a href="https://www.w3.org/TR/shacl/#targets" target="_blank">Target</a> options.
  </div>
</mat-menu>